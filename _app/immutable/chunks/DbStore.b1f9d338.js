import{w as T}from"./index.eb17cf1d.js";import{a1 as D}from"./scheduler.c1c84dbf.js";import{l as A}from"./ProgressBar.svelte_svelte_type_style_lang.ec37df6e.js";import"./index.64b0efba.js";const S="https://virtualpinballspreadsheet.github.io/vps-db/",w=S+"db/vpsdb.json";S+`lastUpdated.json?ts=${new Date().getTime()}`;const $="VirtualPinballSpreadsheet",g="vps-db",k="img/",C="games/",H="staging",I=["tableFiles","povFiles","b2sFiles","romFiles","altColorFiles","altSoundFiles","pupPackFiles","wheelArtFiles","topperFiles","mediaPackFiles","ruleFiles","tutorialFiles"],_=["Hybrid","VR","FSS","4k","MOD","FastFlips","SSF","P-ROC","FlexDMD","Music","incl. B2S","incl. ROM","incl. Art","incl. PuP","incl. Video","no ROM","Kids","Adult","nFozzy","Fleep","LUT","Scorbit","BAM","FizX"],y=["2Screens","3Screens","FullDMD","incl. Table"],L=_.map(e=>({label:e,value:e})),V=y.map(e=>({label:e,value:e})),z={id:"",authors:[],tableFormat:"VPX",urls:[],updatedAt:0},E={id:"",updatedAt:0,manufacturer:"",name:"???",year:0},N={authors:[],id:"",updatedAt:0,urls:[]},X={authors:[],id:"",updatedAt:0,title:"",youtubeId:"dQw4w9WgXcQ"},x={authors:[],id:"",updatedAt:0,urls:[]},r=T({}),B=A("lastUpdatedDb",0),U=async()=>{try{const e=await O(),l={};(await(await fetch(w+`?&ts=${new Date().getTime()}`)).json()).forEach(i=>{const o=i.id;l[o]=i}),B.set(e),console.log("SET DB STORE"),r.set(l)}catch(e){console.log(e)}},v=e=>{var t,i;const s=D(r)[e];if(s){if(s.imgUrl)return s.imgUrl;if((t=s.b2sFiles)!=null&&t.length&&s.b2sFiles[0].imgUrl)return s.b2sFiles[0].imgUrl;if((i=s.tableFiles)!=null&&i.length&&s.tableFiles[0].imgUrl)return s.tableFiles[0].imgUrl}},P=e=>{const l=D(r);if(l[e])return l[e];let s=E;return Object.values(l).forEach(t=>{var i,o,n,c,d,u,m,p,F,b,f,h;(i=t.tableFiles)!=null&&i.some(a=>a.id===e)&&(s=t),(o=t.b2sFiles)!=null&&o.some(a=>a.id===e)&&(s=t),(n=t.romFiles)!=null&&n.some(a=>a.id===e)&&(s=t),(c=t.povFiles)!=null&&c.some(a=>a.id===e)&&(s=t),(d=t.altColorFiles)!=null&&d.some(a=>a.id===e)&&(s=t),(u=t.altSoundFiles)!=null&&u.some(a=>a.id===e)&&(s=t),(m=t.pupPackFiles)!=null&&m.some(a=>a.id===e)&&(s=t),(p=t.wheelArtFiles)!=null&&p.some(a=>a.id===e)&&(s=t),(F=t.mediaPackFiles)!=null&&F.some(a=>a.id===e)&&(s=t),(b=t.topperFiles)!=null&&b.some(a=>a.id===e)&&(s=t),(f=t.soundFiles)!=null&&f.some(a=>a.id===e)&&(s=t),(h=t.ruleFiles)!=null&&h.some(a=>a.id===e)&&(s=t)}),s},O=async()=>{try{const l=await(await fetch(`https://virtualpinballspreadsheet.github.io/vps-db/lastUpdated.json?&ts=${new Date().getTime()}`)).json();return new Date(l).getTime()}catch{return 0}},Q={fetchDb:U,getGameImage:v,getGame:P,lastUpdated:B,dbStore:r};export{V as B,Q as D,X as E,L as T,N as a,z as b,E as c,$ as d,g as e,H as f,k as g,C as h,x as i,I as j};
