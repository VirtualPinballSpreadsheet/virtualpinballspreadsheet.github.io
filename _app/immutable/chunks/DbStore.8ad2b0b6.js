import{w as S}from"./index.eb17cf1d.js";import{a1 as D}from"./scheduler.c1c84dbf.js";import{l as w}from"./ProgressBar.svelte_svelte_type_style_lang.ec37df6e.js";import"./index.64b0efba.js";const B="https://virtualpinballspreadsheet.github.io/vps-db/",y=B+"db/vpsdb.json";B+`lastUpdated.json?ts=${new Date().getTime()}`;const $="VirtualPinballSpreadsheet",k="vps-db",N="img/",C="games/",H="staging",I=["tableFiles","povFiles","b2sFiles","romFiles","altColorFiles","altSoundFiles","pupPackFiles","wheelArtFiles","topperFiles","mediaPackFiles","ruleFiles","tutorialFiles"],_=["Hybrid","VR","FSS","4k","MOD","FastFlips","SSF","P-ROC","FlexDMD","Music","incl. B2S","incl. ROM","incl. Art","incl. PuP","incl. Video","no ROM","Kids","Adult","nFozzy","Fleep","LUT","Scorbit","BAM","FizX"],E=["2Screens","3Screens","FullDMD","incl. Table"],L=_.map(e=>({label:e,value:e})),V=E.map(e=>({label:e,value:e})),z={id:"",authors:[],tableFormat:"VPX",urls:[],updatedAt:0},U={id:"",updatedAt:0,manufacturer:"",name:"???",year:0},X={authors:[],id:"",updatedAt:0,urls:[]},x={authors:[],id:"",updatedAt:0,title:"",youtubeId:"dQw4w9WgXcQ"},J={authors:[],id:"",updatedAt:0,urls:[]},r=S({}),T=S({}),A=w("lastUpdatedDb",0),O=async()=>{try{const e=await R(),i={};(await(await fetch(y+`?&ts=${new Date().getTime()}`)).json()).forEach(l=>{const o=l.id;i[o]=l}),A.set(e),console.log("SET DB STORE"),r.set(i),T.set(JSON.parse(JSON.stringify(i)))}catch(e){console.log(e)}},v=e=>{var t,l;const s=D(r)[e];if(s){if(s.imgUrl)return s.imgUrl;if((t=s.b2sFiles)!=null&&t.length&&s.b2sFiles[0].imgUrl)return s.b2sFiles[0].imgUrl;if((l=s.tableFiles)!=null&&l.length&&s.tableFiles[0].imgUrl)return s.tableFiles[0].imgUrl}},P=e=>{const i=D(r);if(i[e])return i[e];let s=U;return Object.values(i).forEach(t=>{var l,o,n,c,d,u,m,p,F,b,f,h;(l=t.tableFiles)!=null&&l.some(a=>a.id===e)&&(s=t),(o=t.b2sFiles)!=null&&o.some(a=>a.id===e)&&(s=t),(n=t.romFiles)!=null&&n.some(a=>a.id===e)&&(s=t),(c=t.povFiles)!=null&&c.some(a=>a.id===e)&&(s=t),(d=t.altColorFiles)!=null&&d.some(a=>a.id===e)&&(s=t),(u=t.altSoundFiles)!=null&&u.some(a=>a.id===e)&&(s=t),(m=t.pupPackFiles)!=null&&m.some(a=>a.id===e)&&(s=t),(p=t.wheelArtFiles)!=null&&p.some(a=>a.id===e)&&(s=t),(F=t.mediaPackFiles)!=null&&F.some(a=>a.id===e)&&(s=t),(b=t.topperFiles)!=null&&b.some(a=>a.id===e)&&(s=t),(f=t.soundFiles)!=null&&f.some(a=>a.id===e)&&(s=t),(h=t.ruleFiles)!=null&&h.some(a=>a.id===e)&&(s=t)}),s},R=async()=>{try{const i=await(await fetch(`https://virtualpinballspreadsheet.github.io/vps-db/lastUpdated.json?&ts=${new Date().getTime()}`)).json();return new Date(i).getTime()}catch{return 0}},Q={fetchDb:O,getGameImage:v,getGame:P,lastUpdated:A,dbStore:r,dbStoreOriginal:T};export{V as B,Q as D,x as E,L as T,X as a,z as b,U as c,J as d,$ as e,I as f,k as g,H as h,N as i,C as j};
