import{w as D}from"./index.6e379fdf.js";import{a1 as S}from"./scheduler.a453f4b8.js";import{l as A}from"./ProgressBar.svelte_svelte_type_style_lang.c6c4a621.js";import"./index.fa05b556.js";const B="https://virtualpinballspreadsheet.github.io/vps-db/",w=B+"db/vpsdb.json";B+`lastUpdated.json?ts=${new Date().getTime()}`;const V="VirtualPinballSpreadsheet",$="vps-db",k="img/",L="games/",N="staging",C=["tableFiles","povFiles","b2sFiles","romFiles","altColorFiles","altSoundFiles","pupPackFiles","wheelArtFiles","topperFiles","mediaPackFiles","ruleFiles","tutorialFiles"],U=["Hybrid","VR","Mixed Reality","FSS","4k","MOD","Retheme","VPU Patch","FastFlips","SSF","P-ROC","FlexDMD","Music","incl. B2S","incl. ROM","incl. nvram","incl. Art","incl. PuP","incl. Video","no ROM","Kids","Adult","nFozzy","Fleep","VLM","LUT","Scorbit","BAM","FizX","DOF"],_=["2Screens","3Screens","FullDMD","incl. Table"],H=U.map(e=>({label:e,value:e})),I=_.map(e=>({label:e,value:e})),x={id:"",authors:[],tableFormat:"VPX",urls:[],updatedAt:0},E={id:"",updatedAt:0,manufacturer:"",name:"???",year:0},z={authors:[],id:"",updatedAt:0,urls:[]},X={authors:[],id:"",updatedAt:0,title:"",youtubeId:"dQw4w9WgXcQ"},J={authors:[],id:"",updatedAt:0,urls:[]},r=D({}),T=D({}),y=A("lastUpdatedDb",0),O=async()=>{try{const e=await R(),i={};(await(await fetch(w+`?&ts=${new Date().getTime()}`)).json()).forEach(l=>{const o=l.id;i[o]=l}),y.set(e),console.log("SET DB STORE"),r.set(i),T.set(JSON.parse(JSON.stringify(i)))}catch(e){console.log(e)}},P=e=>{var t,l;const s=S(r)[e];if(s){if(s.imgUrl)return s.imgUrl;if((t=s.b2sFiles)!=null&&t.length&&s.b2sFiles[0].imgUrl)return s.b2sFiles[0].imgUrl;if((l=s.tableFiles)!=null&&l.length&&s.tableFiles[0].imgUrl)return s.tableFiles[0].imgUrl}},v=e=>{const i=S(r);if(i[e])return i[e];let s=E;return Object.values(i).forEach(t=>{var l,o,n,c,d,m,u,p,F,b,f,h;(l=t.tableFiles)!=null&&l.some(a=>a.id===e)&&(s=t),(o=t.b2sFiles)!=null&&o.some(a=>a.id===e)&&(s=t),(n=t.romFiles)!=null&&n.some(a=>a.id===e)&&(s=t),(c=t.povFiles)!=null&&c.some(a=>a.id===e)&&(s=t),(d=t.altColorFiles)!=null&&d.some(a=>a.id===e)&&(s=t),(m=t.altSoundFiles)!=null&&m.some(a=>a.id===e)&&(s=t),(u=t.pupPackFiles)!=null&&u.some(a=>a.id===e)&&(s=t),(p=t.wheelArtFiles)!=null&&p.some(a=>a.id===e)&&(s=t),(F=t.mediaPackFiles)!=null&&F.some(a=>a.id===e)&&(s=t),(b=t.topperFiles)!=null&&b.some(a=>a.id===e)&&(s=t),(f=t.soundFiles)!=null&&f.some(a=>a.id===e)&&(s=t),(h=t.ruleFiles)!=null&&h.some(a=>a.id===e)&&(s=t)}),s},R=async()=>{try{const i=await(await fetch(`https://virtualpinballspreadsheet.github.io/vps-db/lastUpdated.json?&ts=${new Date().getTime()}`)).json();return new Date(i).getTime()}catch{return 0}},Q={fetchDb:O,getGameImage:P,getGame:v,lastUpdated:y,dbStore:r,dbStoreOriginal:T};export{I as B,Q as D,X as E,H as T,z as a,x as b,E as c,J as d,V as e,C as f,$ as g,N as h,k as i,L as j};
